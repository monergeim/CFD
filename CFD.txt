#!/bin/bash

dos2unix fxclient5.rolloverdates.properties
a=`whoami`

function load {
scp -o GSSAPIAuthentication=no fxclient5.rolloverdates.properties $a@$1:~
ssh -t -o GSSAPIAuthentication=no $a@$1 '
sudo cp fxclient5.rolloverdates.properties /tmp
sudo su - cosmos -c "cp /tmp/fxclient5.rolloverdates.properties /opt/cosmos/etc"
'
}

for ip in $(awk /^[0-9].*/ ips.txt); do load $ip; done

#MarketsDemo
scp -o GSSAPIAuthentication=no fxclient5.rolloverdates.properties $a@172.31.16.206:~
ssh -t -o GSSAPIAuthentication=no $a@172.31.16.206 '
sudo cp fxclient5.rolloverdates.properties /tmp
sudo su - csmarketsdemo -c "cp /tmp/fxclient5.rolloverdates.properties /opt/csmarketsdemo/etc/"
'

#MarketsLive
scp -o GSSAPIAuthentication=no fxclient5.rolloverdates.properties $a@172.31.17.225:~
ssh -t -o GSSAPIAuthentication=no $a@172.31.17.225 '
sudo cp fxclient5.rolloverdates.properties /tmp
sudo su - csmarketslive -c "cp /tmp/fxclient5.rolloverdates.properties /opt/csmarketslive/etc/; /tmp/git_load.sh"
'

ssh -t -o GSSAPIAuthentication=no $a@172.31.17.225 'sudo su - csmarketslive -c "/tmp/git_load.sh"'

echo Congrats!!!